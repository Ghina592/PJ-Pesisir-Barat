<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Detail Event - Pesisir Barat</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Poppins:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="index.css" />
    <meta name="theme-color" content="#e9caa2" />
  </head>
  <body>
    <header class="hero">
      <div class="hero-header">
        <img src="assets/img/logo-small.png" class="hero-logo" onclick="window.location.href='index.html'" style="cursor: pointer;" />
        <div class="hero-text">
          <h3>PEMERINTAHAN</h3>
          <h4>KABUPATEN PESISIR BARAT</h4>
        </div>
      </div>

      <div class="hero-center">
        <h1>SELAMAT DATANG DI WEBSITE RESMI</h1>
        <h2>KABUPATEN PESISIR BARAT</h2>
      </div>

      <div class="hamburger" id="hamburgerBtn">☰</div>

      <nav class="main-nav">
        <div class="nav-item" onclick="window.location.href='index.html'">BERANDA</div>
        <div class="nav-item" onclick="window.location.href='profil.html'">PROFIL</div>
        <div class="nav-item" onclick="window.location.href='pariwisata.html'">PARIWISATA</div>
      </nav>
    </header>

    <main class="container">
      <!-- Breadcrumb -->
      <nav class="breadcrumb">
        <a href="index.html">BERANDA</a> &gt; 
        <a href="event.html">EVENT</a> &gt; 
        <span>DETAIL EVENT</span>
      </nav>

      <div class="page-layout">
        <!-- Main Content -->
        <article class="main-content detail-article event-detail">
          <h1 id="eventTitle" class="article-title">Loading...</h1>
          
          <div class="article-meta event-meta">
            <span><img src="assets/icon-date.png" alt="" /> <span id="eventDate"></span></span>
            <span><img src="assets/map.png" alt="" style="width:20px" /> <span id="eventLocation"></span></span>
          </div>

          <img id="eventImage" src="" alt="" class="article-hero-image event-poster" />

          <div id="eventContent" class="article-content">
            <!-- Content will be loaded here -->
          </div>

          <div class="event-tickets">
            <h3>Harga Tiket</h3>
            <div id="ticketPrices" class="ticket-grid">
              <!-- Ticket prices will be loaded here -->
            </div>
          </div>

          <div class="event-contact">
            <h3>Informasi & Pendaftaran</h3>
            <div id="eventContact" class="contact-info">
              <!-- Contact info will be loaded here -->
            </div>
          </div>

          <div class="event-actions">
            <a id="registerBtn" href="#" class="btn btn-primary" target="_blank">Daftar Sekarang</a>
            <button class="btn btn-secondary" onclick="shareEvent()">Bagikan Event</button>
          </div>
        </article>

        <!-- Sidebar -->
        <aside class="sidebar">
          <div class="sidebar-card">
            <h3>EVENT LAINNYA</h3>
            <ul id="otherEvents" class="sidebar-list">
              <!-- Other events will be loaded here -->
            </ul>
          </div>
        </aside>
      </div>
    </main>

    <footer class="site-footer">
      <div class="container footer-grid">
        <div class="footer-about">
          <img src="assets/img/logo-small.png" alt="logo" class="footer-logo" />
          <h2 class="footer-title">PEMERINTAHAN <br /><span>KABUPATEN PESISIR BARAT</span></h2>
          <div class="footer-address">
            <p><img src="assets/map.png" /> Jl. Kesuma No. 1 Gedung A Lt.1 Kompleks Perkantoran Pemda, Kec. Pesisir Tengah</p>
            <p>Kabupaten Pesisir Barat, Provinsi Lampung – Indonesia 34874</p>
          </div>
        </div>

        <div class="footer-follow">
          <h3 class="footer-heading">IKUTI KAMI</h3>
          <div class="social-icons">
            <a href="#"><img src="assets/youtube.png" alt="yt" /></a>
            <a href="#"><img src="assets/facebook.png" alt="fb" /></a>
            <a href="#"><img src="assets/instagram.png" alt="ig" /></a>
            <a href="#"><img src="assets/twitter.png" alt="tw" /></a>
          </div>
        </div>

        <div class="footer-map">
          <h3 class="footer-heading">LOKASI</h3>
          <img src="assets/lokasi.png" class="map-img" alt="Map" />
        </div>
      </div>

      <div class="footer-bottom" style="text-align: center">
        © <span id="year"></span> Pemerintah Kabupaten Pesisir Barat — All rights reserved.
      </div>
    </footer>

    <script src="script.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', async function() {
        const id = getUrlParam('id');
        if (!id) {
          window.location.href = 'event.html';
          return;
        }

        const event = await DataManager.getById('event', id);
        if (!event) {
          document.querySelector('.event-detail').innerHTML = '<p>Event tidak ditemukan.</p>';
          return;
        }

        // Populate event details
        document.getElementById('eventTitle').textContent = event.nama;
        document.getElementById('eventDate').textContent = formatDateLong(event.tanggal) + ' - ' + event.waktu;
        document.getElementById('eventLocation').textContent = event.lokasi;
        document.getElementById('eventImage').src = event.gambar;
        document.getElementById('eventImage').alt = event.nama;
        
        // Format content
        const content = event.deskripsi.split('\n\n').map(p => `<p>${p}</p>`).join('');
        document.getElementById('eventContent').innerHTML = content;

        // Ticket prices
        const tickets = document.getElementById('ticketPrices');
        if (event.hargaTiket && tickets) {
          tickets.innerHTML = Object.entries(event.hargaTiket).map(([type, price]) => `
            <div class="ticket-item">
              <span class="ticket-type">${type.toUpperCase()}</span>
              <span class="ticket-price">${price}</span>
            </div>
          `).join('');
        }

        // Contact info
        const contact = document.getElementById('eventContact');
        if (event.kontak && contact) {
          contact.innerHTML = `
            <p><img src="assets/instagram.png" alt="" style="width:20px" /> ${event.kontak.instagram}</p>
            <p><img src="assets/wa.png" alt="" style="width:20px" /> ${event.kontak.whatsapp}</p>
          `;
        }

        // Registration button
        const registerBtn = document.getElementById('registerBtn');
        if (event.linkPendaftaran) {
          registerBtn.href = event.linkPendaftaran;
        } else {
          registerBtn.style.display = 'none';
        }

        // Update page title
        document.title = `${event.nama} - Pesisir Barat`;

        // Load other events
        const allEvents = await DataManager.load('event');
        const others = allEvents.filter(e => e.id !== id);
        const othersList = document.getElementById('otherEvents');
        if (othersList) {
          othersList.innerHTML = others.map(e => `
            <li>
              <a href="detail-event.html?id=${e.id}">
                <img src="${e.gambar}" alt="" class="sidebar-thumb" />
                <div>
                  <span class="sidebar-title">${e.nama}</span>
                  <span class="sidebar-date">${formatDate(e.tanggal)}</span>
                </div>
              </a>
            </li>
          `).join('');
        }
      });

      function shareEvent() {
        if (navigator.share) {
          navigator.share({
            title: document.getElementById('eventTitle').textContent,
            url: window.location.href
          });
        } else {
          window.open(`https://wa.me/?text=${encodeURIComponent(window.location.href)}`, '_blank');
        }
      }
    </script>
  </body>
</html>
